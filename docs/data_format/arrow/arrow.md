# Apache Arrow

指定了一种与语言无关的标准化列式存储格式，支持平面（表型）和层次数据。

- **零拷贝的共享内存**和基于RPC的数据移动；
- 支持读/写文件格式（如CSV，ORC 和 Parquet）；
- 基于内存的分析和查询处理；

![通用数据层](./pics/arrow_shared.png)

## Format

内存中数据结构规范，元数据序列化以及用于序列化和通用数据传输的协议。

**利用Google的[Flatbuffers](http://github.com/google/flatbuffers)项目进行元数据序列化**

列式格式具有一些关键功能：

- 顺序访问（扫描）的邻接的数据
- O(1)（恒定时间）随机访问
- SIMD和矢量化友好
- 可重定位而无需“指针混乱”，从而允许在共享内存中进行真正的零拷贝访问

### Array

由元数据和数据定义：

- 逻辑数据类型；
- 缓冲区序列；
- 长度为64位有符号整数。允许将实现限制为32位；
- null的数目作为64位有符号整数。
- 可选的**dictionary**，用于字典编码的数组。

### TODO：每种类型的内存布局

## IPC

列格式的序列化数据的原始单位是“批记录”（record batch)。

定义协议，用于将记录批处理序列化为二进制有效负载流，并从这些**有效负载中重建记录批处理而无需进行内存复制**。